---
import Layout from "../components/Layout.astro";
import ServiceCard from "../components/ServiceCard.astro";
import Testimonial from "../components/Testimonial.astro";
import { SITE } from "../data/site";
import { getCollection, getEntryBySlug } from "astro:content";

const home = await getEntryBySlug('pages', 'home');
const services = await getCollection('services', s => s.data.published !== false);
const featured = services
  .filter(s => s.data.featured)
  .sort((a,b)=>(a.data.order??999)-(b.data.order??999))
  .slice(0,3);
---
<Layout
  title="A.R. Euro Forêt — Travaux forestiers, élagage & abattage"
  description="Entreprise d’élagage, abattage et travaux forestiers. Interventions sécurisées pour particuliers, professionnels et collectivités. Devis gratuit."
>
  <section class="section pt-8 md:pt-16">
    <div class="container grid md:grid-cols-2 gap-10 items-center">
      <div data-reveal>
        <h1 class="text-3xl md:text-5xl font-display font-extrabold leading-tight">
          {home?.data.titleHero ?? "Élagage, abattage & travaux forestiers — interventions sécurisées"}
        </h1>
        <p class="lead mt-4">{home?.data.intro}</p>
        {home?.data.bullets && (
          <ul class="mt-6 space-y-2 text-anth/80">
            {home.data.bullets.map((b:string) => <li>• {b}</li>)}
          </ul>
        )}
        <div class="mt-8 flex gap-3">
          <a href="/contact" class="btn btn-primary">Demander un devis</a>
          <a href={"tel:" + SITE.phoneE164} class="btn btn-ghost" aria-label={`Appeler ${SITE.name}`}>Appeler maintenant</a>
        </div>
      </div>
      <div class="relative" data-reveal>
        <img src="/images/hero.svg" alt="Intervention d’élagage en sécurité" class="w-full h-auto drop-shadow" loading="eager" />
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <h2 class="text-2xl md:text-3xl font-display font-bold mb-6" data-reveal>Nos services</h2>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        {featured.map((s) => (
          <ServiceCard
            title={s.data.title}
            description={s.data.excerpt ?? ""}
            href={`/services/${s.slug}`}
            ctaType={s.data.ctaType}
            ctaLabel={s.data.ctaLabel}
          />
        ))}
      </div>
      <div class="mt-6">
        <a class="btn btn-ghost" href="/services">Voir tous les services</a>
      </div>
    </div>
  </section>

  <section class="section section-alt">
    <div class="container grid md:grid-cols-3 gap-6">
      <Testimonial quote="Un travail rapide et propre, je recommande." />
      <Testimonial quote="Très professionnel et à l'écoute, excellent rapport qualité-prix." />
      <Testimonial quote="Intervention sérieuse, je referai appel à eux sans hésiter." />
    </div>
  </section>
</Layout>
